$(document).ready(function(){$("#re-password").keyup(function(){$("#password").val()!=$("#re-password").val()?($("#password").addClass("error"),$("#re-password").addClass("error"),condition=!0):(condition=!1,$("#password").removeClass("error"),$("#re-password").removeClass("error"))});$("#form").submit(function(){condition||(loadForm(),$("#loader-login").show(),$("button[type='submit']").attr("disabled","disabled"),updateProfile())});$("div.picture > div > div").click(function(){0==$(this).next().attr("showed")?
($(this).next().slideDown("fast"),$(this).next().attr("showed",1)):($(this).next().slideUp("fast"),$(this).next().attr("showed",0))});$("#upload-picture").click(function(){$("#picture").trigger("click");$("div.picture > div > ul").slideUp("fast").attr("showed",0);$("#action").val("uploaded")});$("#delete-picture").click(function(){$("div.picture > div > ul").slideUp("fast").attr("showed",0);$("#photo").attr("src",imageDefault);$("#action").val("deleted")});$("#take-picture").click(function(){$("div.picture > div > ul").slideUp("fast").attr("showed",
0);$(".content-modal").show();$(".modal").hide();$(".modal-camera").show();$("#loader-upload-camera").show();$("#action").val("taked");initCamera()});$(".modal-camera .close").click(function(){$(".content-modal").hide();$(".modal").show();$(".modal-camera").hide()});$("#camera-cancel").click(function(){cancelCamera()});$("#camera-take").click(function(){shootEnabled&&takeCamera()});$("#camera-upload").click(function(){uploadCamera()});$("#camera-config").click(function(){shootEnabled&&configCamera()});
$("#picture").change(function(){var a=new FileReader,b=new Image,c=this.files[0];c.type.match(/image.*/)&&(a.readAsDataURL(c),window.FileReader&&(a.onloadend=function(d){b.src=a.result;b.onload=function(){100<this.width&&120<this.height&&($("#photo").attr("src",d.target.result),data.append("file",c))}}))})});
function updateProfile(){$.ajax({url:addressUpdateProfile,type:"POST",data:data,cache:!1,contentType:!1,dataType:"json",processData:!1,success:function(a){a.state&&($("#loader-login").fadeOut("fast"),showMessage(a.type),$("button[type='submit']").removeAttr("disabled"))}})}function loadForm(){$.each($("#form").find('input[type!="submit"]'),function(){data.append($(this).attr("name"),$(this).val())})}
function initCamera(){$("#camera");$("#picture");var a=$("#source");webcam.set_swf_url(webSource+"webcam.swf");webcam.set_api_url(addressUploadCamera);webcam.set_quality(100);webcam.set_shutter_sound(!0,webSource+"shutter.mp3");a.html(webcam.get_html(a.width(),a.height()));webcam.set_hook("onLoad",function(){shootEnabled=!0});webcam.set_hook("onComplete",function(a){a=$.parseJSON(a);a.error?alert(a.message):($("#loader-upload-camera").hide(),$("#photo").attr("src",imageDefault),$("#photo").attr("src",
a.src+"?"+(new Date).getTime()),$(".content-modal").hide(),$(".modal").show(),$(".modal-camera").hide())});webcam.set_hook("onError",function(b){a.html(b)});$("#loader-upload-camera").hide();manageButtons(1)}function manageButtons(a){switch(a){case 1:$("#camera-upload").hide();$("#camera-take").show();$("#camera-cancel").hide();$("#camera-config").show();break;case 2:$("#camera-upload").show(),$("#camera-take").hide(),$("#camera-cancel").show(),$("#camera-config").hide()}}
function takeCamera(){manageButtons(2);webcam.freeze();return!1}function cancelCamera(){webcam.reset();manageButtons(1);return!1}function uploadCamera(){$("#loader-upload-camera").show();webcam.upload();manageButtons(1);return!1}function configCamera(){webcam.configure("camera")};