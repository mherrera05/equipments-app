$(document).ready(function(){$("#form").submit(function(){validation()&&($("#loader-login").show(),$("button[type='submit']").attr("disabled","disabled"),updateEquipment($(this).serialize()))});$("#type").change(function(){""!=$("#brand").val()&&($("#loader-model").show(),searchModels($(this).val(),$("#brand").val()))});$("#brand").change(function(){""!=$("#type").val()&&($("#loader-model").show(),searchModels($("#type").val(),$(this).val()))});$("#serial").change(function(){searchSerial($(this).val())});
$("#mac").change(function(){0<$(this).val().length&&macAddress($(this).val(),$(this))}).keyup(function(a){17>=$(this).val().length?($(this).val().slice(-1).match(/[0-9A-Fa-f]/)||(a=$(this).val(),$(this).val(a.substring(0,a.length-1))),macAddress($(this).val(),$(this))):0!=$(this).val().length&&(a=$(this).val(),$(this).val(a.substring(0,a.length-1)))})});
function searchModels(a,d){$("#model").html("<option value=''>Choose..</option>");$.post(addressSearchModels,"type="+a+"&brand="+d,function(a){a.state&&(""!=a.type?showMessage(a.type):loadElement($("#model"),a.models),$("#loader-model").fadeOut("fast"))},"JSON")}function searchSerial(a){a="serial="+a+"&id="+$("#id").val();$.post(addressSearchSerial,a,function(a){a.state?$("#serial").removeClass("error"):($("#serial").addClass("error"),showMessage(79))},"JSON")}
function searchMac(a){a="mac="+a+"&id="+$("#id").val();$.post(addressSearchMac,a,function(a){a.state?$("#mac").removeClass("error"):($("#mac").addClass("error"),showMessage(81))},"JSON")}function updateEquipment(a){$.post(addressUpdateEquipment,a,function(a){a.state&&($("#loader-login").fadeOut("fast"),showMessage(a.type),$("button[type='submit']").removeAttr("disabled"))},"JSON")}function validation(){return $("#serial").hasClass("error")||$("#mac").hasClass("error")?!1:!0}
function macAddress(a,d){for(var b="",c=0;c<a.length&&!(16<c||16<b.length);c++)2!=b.length&&5!=b.length&&8!=b.length&&11!=b.length&&14!=b.length||"-"==a[c]||(b+="-"),b+=a[c];d.val(b.toUpperCase());searchMac(b.toUpperCase())};