$(document).ready(function(){$("#equipments").multiSelect({selectableHeader:"<div class='custom-header'>Equipments installed</div>",selectionHeader:"<div class='custom-header'>Equipments to uninstall</div>"});$("#refer").multiSelect({selectableHeader:"<div class='custom-header'>Staff</div>",selectionHeader:"<div class='custom-header'>Copy to</div>"});$("#select-all").click(function(){$("#equipments").multiSelect("select_all");return!1});$("#deselect-all").click(function(){$("#equipments").multiSelect("deselect_all");
return!1});$("#select-all-notify").click(function(){$("#refer").multiSelect("select_all");return!1});$("#deselect-all-notify").click(function(){$("#refer").multiSelect("deselect_all");return!1});$("#project").change(function(){""!=$(this).val()&&($("#loader-project").show(),searchLocation($(this).val()))});$("#projects-move").change(function(){""!=$(this).val()&&($("#loader-center").show(),searchCenter($(this).val()))});$("#location").change(function(){$("#loader-location").show();loadEquipments($(this).val())});
$("#form").submit(function(){validate()&&($("#loader-login").show(),$("button[type='submit']").attr("disabled","disabled"),createUninstallation($(this).serialize()))});$("#uninstallation").click(function(){uninstallation()});$("#move").click(function(){move()});$("#date").datepicker({dateFormat:"yy-mm-dd"});$("#state").change(function(){1==$(this).val()?($("#notify").show(),$("#notify").next().show()):($("#notify").next().hide(),$("#notify").hide())})});
function move(){$("#location-center").html("<option value=''>Choose..</option>");$("#move-equip").find("select").removeAttr("disabled","disabled");$("#uninstall-equip").hide();$("#move-equip").show();$("#uninstall-equip").find("select").attr("disabled","disabled");return 0}function uninstallation(){$("#uninstall-equip").find("select").removeAttr("disabled","disabled");$("#move-equip").hide();$("#uninstall-equip").show();$("#move-equip").find("select").attr("disabled","disabled");return 0}
function searchLocation(b){$("#location").html("<option value=''>Choose..</option>");$.post(addressSearchLocation,"project="+b,function(a){a.state&&(""!=a.type?showMessage(a.type):loadElement($("#location"),a.locations),$("#loader-project").fadeOut("fast"))},"JSON")}
function searchCenter(b){$("#location-center").html("<option value=''>Choose..</option>");$.post(addressSearchLocation,"project="+b,function(a){a.state&&(""!=a.type?showMessage(a.type):loadElement($("#location-center"),a.locations),$("#loader-center").fadeOut("fast"))},"JSON")}
function loadEquipments(b){$.post(addressLoadDetails,"id="+b,function(a){if(a.state){$("#equipments").html("");if(""!=a.equipments){$(".alert").hide();for(var b="",c=0;c<a.equipments.length;c++)1==a.equipments[c].related&&(b+='<option value="'+a.equipments[c].id+'">'+a.equipments[c].brand+" "+a.equipments[c].model+"</option>");$("#equipments").html(b);$("#equipments").multiSelect("refresh")}else b="",$("#equipments").html(b),$("#equipments").multiSelect("refresh"),showMessage(a.type);$("#loader-location").hide()}},
"JSON");return!1}function createUninstallation(b){b=b+"&equipments="+$("#equipments").val();$.post(addressCreateUninstallation,b,function(a){a.state&&($("#loader-login").hide(),showMessage(a.type),$("#form")[0].reset(),$("#equipments").html(""),$("#equipments").multiSelect("refresh"),$("#refer").multiSelect("refresh"),uninstallation(),$("button[type='submit']").removeAttr("disabled"))},"JSON");return!1}
function validate(){return null==$("#equipments").val()?($(".ms-list").addClass("error"),!1):!0};